(function(a){function g(a){return a.replace(/[<>"'`]|&(?!amp;)/g,function(a){return e[a]})}function h(a,b){return c[a]=b.replace(/^\s+|\s+$/g,""),this}function i(a,b){return h(b||a.getAttribute("rel"),a.innerHTML),a.parentNode.removeChild(a),this}function j(a,b){return d[a]=b||f[a],this}function k(){var a,c;if(document.querySelectorAll)a=document.querySelectorAll('script[type="'+b+'"][rel]');else{var d=document.getElementsByTagName("script");for(c=d.length,a=[];c--;)d[c].getAttribute("type")===b&&d[c].getAttribute("rel")&&a.push(d[c])}for(c=a.length;c--;)i(a[c]);return this}function l(a,b,c){var e,f;if(~b.indexOf("|")){var g=b.split("|"),h;b=g.shift(),h=l(a,b,c);for(e=0,f=g.length;e<f;e++)g[e].match(/^\s*!?=/)?g[e].replace(/^\s*(!?)=(.*)\s*$/,function(a,b,c){h=b?h!=c?h:!1:h==c?h:!1}):(d[g[e]]||j(g[e]),h=d[g[e]](h));return h}b.match(/^\//)&&(b=b.substr(1),c="");while(b.match(/^..\//))c=~c.indexOf(".")?"":c.replace(/\.[^\.]*$/,""),b=b.replace(/^..\//,"");b=b.replace(/^\.+/,""),c=c.replace(/^\/+/,"").replace(/^\.+/,""),b=(c||"")+(c&&b?".":"")+b;if(!b.length)return a;b=b.split(/\s*\.\s*/);var i=a;for(e=0,f=b.length;e<f;e++)if(b[e]in i)i=i[b[e]];else return null;return i}function m(a,b,d){return d||(d=""),a.replace(/\{\{\s*#([^\{\s]+?)\}\}([\s\S]*?)\{\{\/\1\}\}/g,function(a,c,e){var f=[],g=l(b,c,d),h=(d?d+".":"")+c,i;if(!g)return"";for(i in g)g.hasOwnProperty(i)&&f.push(m(e,b,h+"."+i));return f.join("")}).replace(/\{\{\s*(([^\{\s\|]+?)(\|[^\{\s]+?)?)\s*(!)?\?\s*\}\}([\s\S]*?)\{\{\s*\?\s*(\1|\2)\s*\}\}/g,function(a,c,e,f,g,h){var i=l(b,c,d),j=i?i instanceof Array?i.length:!0:!1;return g&&(j=!j),j?m(h,b,d):""}).replace(/\{\{\s*>\s*([a-z_][a-z_0-9]*)\s*\}\}/ig,function(a,e){return c[e]?m(c[e],b,d):""}).replace(/\{\{\{\s*([^\{\s]*?)\s*\}\}\}/g,function(a,c){return g(l(b,c,d))}).replace(/\{\{\s*([^\{\s]*?)\s*\}\}/g,function(a,c){return l(b,c,d)})}function n(a,b){if(c[a]===undefined){k();if(c[a]===undefined)return!1}return m(c[a],b)}"use strict";var b="text/stpl",c={},d={empty:function(a){return!a||a==="0"||a instanceof Array&&!a.length},upperCase:function(a){return a.toString().toUpperCase()},lowerCase:function(a){return a.toString().toLowerCase()},ucFirst:function(a){return a=a.toString(),a.substr(0,1).toUpperCase()+a.substr(1)}},e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},f=typeof global!="undefined"?global:(new Function("return this;"))();n.registerScriptTag=i,n.registerString=h,n.registerFilter=function(a,b){return j(a,b),this},n.preload=k,n.renderString=m,a.stpl=n})(typeof exports=="object"?exports:this)